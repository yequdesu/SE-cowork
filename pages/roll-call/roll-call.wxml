<view class="container">
  
  <!-- é¡¶éƒ¨å¯¼èˆªï¼šèƒ¶å›Šåˆ‡æ¢ -->
  <view class="header fade-in">
    <view class="header-text">
      <text class="title">è¯¾å ‚ç‚¹å</text>
      <text class="subtitle">å…¬å¹³éšæœºï¼Œé«˜æ•ˆè®°å½•</text>
    </view>
    
    <view class="segment-control">
      <view 
        class="segment-item {{currentMode === 'random' ? 'active' : ''}}" 
        bindtap="selectMode" 
        data-mode="random"
      >éšæœº</view>
      <view 
        class="segment-item {{currentMode === 'sequential' ? 'active' : ''}}" 
        bindtap="selectMode" 
        data-mode="sequential"
      >é¡ºåº</view>
      <!-- æ»‘å—èƒŒæ™¯ (å¯é€‰ï¼Œé…åˆ CSS å®ç°å¹³æ»‘ç§»åŠ¨ï¼Œè¿™é‡Œç®€åŒ–å¤„ç†) -->
    </view>
  </view>

  <!-- æ ¸å¿ƒå±•ç¤ºåŒºï¼šæŠ½å¥–å¡ç‰Œ -->
  <view class="hero-section slide-up" style="animation-delay: 0.1s;">
    <view class="student-card {{currentStudent.name ? 'has-data' : 'is-empty'}}">
      
      <!-- è£…é¥°èƒŒæ™¯åœ† -->
      <view class="bg-circle c-1"></view>
      <view class="bg-circle c-2"></view>

      <!-- çŠ¶æ€ A: å¾…æœºä¸­ -->
      <view wx:if="{{!currentStudent.name}}" class="state-empty">
        <view class="empty-icon-box">
          <text class="icon-pulse">ğŸ²</text>
        </view>
        <text class="empty-hint">ç‚¹å‡»æŒ‰é’®å¼€å§‹æŠ½å–</text>
      </view>

      <!-- çŠ¶æ€ B: é€‰ä¸­ç»“æœ -->
      <view wx:else class="state-result">
        <view class="avatar-ring">
          <view class="avatar">{{currentStudent.name[0]}}</view>
        </view>
        <text class="result-name">{{currentStudent.name}}</text>
        <text class="result-id">{{currentStudent.student_id}}</text>
        <view class="shine-overlay"></view>
      </view>
    </view>
  </view>

  <!-- æ ¸å¿ƒæ“ä½œæŒ‰é’® -->
  <view class="action-section slide-up" style="animation-delay: 0.2s;">
    <button 
      class="btn-main" 
      hover-class="btn-main-hover" 
      bindtap="performRollCall"
    >
      <text class="btn-icon">âš¡ï¸</text>
      <text>å¼€å§‹ç‚¹å</text>
      <view class="btn-shine"></view>
    </button>
  </view>

  <!-- è¯„ä»·è¡¨å• (é€‰äººåæ˜¾ç¤º) -->
  <view class="evaluation-panel {{currentStudent.name ? 'is-visible' : ''}} slide-up" style="animation-delay: 0.3s;">
    <view class="panel-header">
      <text class="panel-title">è¯¾å ‚è¡¨ç°</text>
      <view class="status-indicator"></view>
    </view>
    
    <view class="panel-body">
      <!-- å¿«æ·æ ‡ç­¾ -->
      <view class="tags-container">
        <view 
          class="tag-chip {{arrived ? 'active-green' : ''}}" 
          bindtap="toggleArrived"
          hover-class="chip-hover"
        >
          <text class="chip-icon">{{arrived ? 'âœ“' : 'â—‹'}}</text>
          <text>å·²åˆ°åœº</text>
        </view>
        
        <view 
          class="tag-chip {{repeatedQuestion ? 'active-orange' : ''}}" 
          bindtap="toggleRepeated"
          hover-class="chip-hover"
        >
          <text class="chip-icon">{{repeatedQuestion ? 'âœ“' : '?'}}</text>
          <text>é‡å¤æé—®</text>
        </view>
      </view>

      <!-- è¯„åˆ†è¾“å…¥ -->
      <view class="score-wrapper">
        <text class="label">è¯„åˆ†</text>
        <view class="input-box">
          <input 
            class="score-input" 
            placeholder="0" 
            value="{{scoreInput}}" 
            bindinput="onScoreInput" 
            type="number" 
            maxlength="2"
            confirm-type="done"
          />
          <text class="suffix">åˆ†</text>
        </view>
      </view>
    </view>

    <button class="btn-submit" hover-class="btn-sub-hover" bindtap="submitUpdate">
      ç¡®è®¤è®°å½•
    </button>
  </view>

</view>