<view class="container">
  
  <!-- é¡¶éƒ¨æ ï¼šæ ‡é¢˜ + åˆ·æ–° -->
  <view class="header-bar">
    <text class="page-title">ç§¯åˆ†æ’è¡Œæ¦œ</text>
    <view class="refresh-icon" bindtap="refreshData" hover-class="icon-hover">
      <text class="icon-text">â†» åˆ·æ–°</text>
    </view>
  </view>

  <!-- åŠ è½½ä¸­ -->
  <view wx:if="{{loading}}" class="loading-state">
    <view class="spinner"></view>
    <text>æ­£åœ¨åŒæ­¥æ•°æ®...</text>
  </view>

  <view wx:else class="content-body">
    
    <!-- é¡¶éƒ¨å‰ä¸‰åå±•ç¤º (Podium) -->
    <view class="top-three" wx:if="{{rankings.length >= 3}}">
      <!-- äºšå†› (å·¦) -->
      <view class="podium-item rank-2">
        <view class="crown silver">2</view>
        <view class="avatar">{{rankings[1].name[0]}}</view>
        <text class="name">{{rankings[1].name}}</text>
        <text class="score">{{rankings[1].score}}</text>
      </view>
      
      <!-- å† å†› (ä¸­ï¼Œæœ€å¤§) -->
      <view class="podium-item rank-1">
        <view class="crown gold">ğŸ‘‘</view>
        <view class="avatar main">{{rankings[0].name[0]}}</view>
        <text class="name">{{rankings[0].name}}</text>
        <text class="score main">{{rankings[0].score}}</text>
      </view>
      
      <!-- å­£å†› (å³) -->
      <view class="podium-item rank-3">
        <view class="crown bronze">3</view>
        <view class="avatar">{{rankings[2].name[0]}}</view>
        <text class="name">{{rankings[2].name}}</text>
        <text class="score">{{rankings[2].score}}</text>
      </view>
    </view>

    <!-- ç»Ÿè®¡å›¾è¡¨ (æ”¹ä¸ºæ¨ªå‘æ»šåŠ¨ï¼Œé˜²æ­¢æ‹¥æŒ¤) -->
    <view class="section-card">
      <text class="section-title">è¶‹åŠ¿åˆ†æ</text>
      <scroll-view scroll-x class="chart-scroll" enable-flex>
        <view class="chart-wrapper">
          <view wx:for="{{rankings}}" wx:key="studentId" class="bar-group">
            <text class="bar-val">{{item.score}}</text>
            <!-- åŠ¨æ€é«˜åº¦ + æ¸å˜è‰² -->
            <view class="bar" style="height: {{item.score * 4}}rpx; background: {{index < 3 ? 'var(--gradient-gold)' : 'var(--gradient-blue)'}}"></view>
            <text class="bar-name">{{item.name}}</text>
          </view>
        </view>
      </scroll-view>
    </view>

    <!-- è¯¦ç»†æ’ååˆ—è¡¨ -->
    <view class="list-section">
      <text class="section-title">è¯¦ç»†åå•</text>
      <view class="list-header">
        <text class="col-rank">æ’å</text>
        <text class="col-name">å­¦ç”Ÿä¿¡æ¯</text>
        <text class="col-data">ç‚¹å / ç§¯åˆ†</text>
      </view>

      <view wx:for="{{rankings}}" wx:key="studentId" class="rank-card">
        <!-- æ’åå¾½ç«  -->
        <view class="rank-badge {{index < 3 ? 'top-' + (index + 1) : ''}}">
          {{index + 1}}
        </view>
        
        <!-- ä¿¡æ¯ -->
        <view class="info-block">
          <text class="student-name">{{item.name}}</text>
          <text class="student-id">{{item.studentId}}</text>
        </view>
        
        <!-- æ•°æ® -->
        <view class="data-block">
          <text class="count-label">{{item.rollCallCount}}æ¬¡</text>
          <text class="score-val">{{item.score}}</text>
        </view>
      </view>
    </view>

  </view>
</view>